<!doctype html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Flip Clock</title>

<!-- React (UMD) + Babel to run JSX in the browser -->
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<div id="root"></div>

<script type="text/babel">
/* === Paste of your FlipClock (converted to plain JS) === */
const { useEffect, useMemo, useRef, useState } = React;

function FlipClock() {
  const [now, setNow] = useState(new Date());
  const [twelveHour, setTwelveHour] = useState(getStoredBool("flipclock:twelveHour", false));
  const [fgColor, setFgColor] = useState(getStored("flipclock:fg", "#111111"));
  const [bgColor, setBgColor] = useState(getStored("flipclock:bg", "#ffffff"));
  const [panelOpen, setPanelOpen] = useState(false);

  useEffect(() => { const id = setInterval(() => setNow(new Date()), 1000); return () => clearInterval(id); }, []);
  useEffect(() => store("flipclock:twelveHour", String(twelveHour)), [twelveHour]);
  useEffect(() => store("flipclock:fg", fgColor), [fgColor]);
  useEffect(() => store("flipclock:bg", bgColor), [bgColor]);

  const { hh, mm, ss, ampm } = useMemo(() => formatParts(now, twelveHour), [now, twelveHour]);

  const startY = useRef(null);
  const onTouchStart = (e) => { startY.current = e.touches[0].clientY; };
  const onTouchEnd = (e) => {
    const endY = e.changedTouches[0].clientY;
    if (startY.current !== null && startY.current - endY > 40) setPanelOpen(true);
    startY.current = null;
  };

  return (
    <div className="min-h-screen w-full flex items-center justify-center select-none"
         style={{ backgroundColor: bgColor, color: fgColor }}
         onTouchStart={onTouchStart} onTouchEnd={onTouchEnd}>
      <style>{`
        @keyframes blink { 0%, 49% { opacity: 1; } 50%, 100% { opacity: 0; } }
        .blink { animation: blink 1s steps(1,end) infinite; }
        .digital7 { font-family: 'Digital-7','DS-Digital','Segment7','DSEG7 Classic','Seven Segment',ui-monospace,Menlo,Consolas,'Courier New',monospace; letter-spacing: .04em; }
        .colon-dot { width: .18em; height: .18em; border-radius: 9999px; display: block; background: currentColor; }
        .flip-digit { position: relative; display: inline-block; line-height: 1; perspective: 1000px; }
        .abs-fill { position: absolute; inset: 0; }
        .flip-face { line-height: 1; }
        .clip-top { clip-path: inset(0 0 50.1% 0); }
        .clip-bottom { clip-path: inset(49.9% 0 0 0); }
        .flip-layer { position: absolute; inset: 0; transform-style: preserve-3d; backface-visibility: hidden; }
        .flip-upper { top: 0; transform-origin: center bottom; }
        .flip-lower { bottom: 0; transform-origin: center top; }
        @keyframes flipTopDown { from { transform: rotateX(0); } to { transform: rotateX(-90deg); } }
        @keyframes flipBottomUp { from { transform: rotateX(90deg); } to { transform: rotateX(0); } }
        .run-top { animation: flipTopDown .28s ease-in forwards; }
        .run-bottom { animation: flipBottomUp .28s ease-out .18s forwards; }
        /* Tiny Tailwind-lite utilities used in markup */
        .min-h-screen{min-height:100vh}.w-full{width:100%}.flex{display:flex}.items-baseline{align-items:baseline}.items-center{align-items:center}.justify-center{justify-content:center}.gap-3{gap:.75rem}.ml-2{margin-left:.5rem}.opacity-80{opacity:.8}.opacity-70{opacity:.7}.select-none{user-select:none}
        .fixed{position:fixed}.bottom-3{bottom:.75rem}.left-1\\/2{left:50%}.px-3{padding-left:.75rem;padding-right:.75rem}.py-1{padding:.25rem .5rem}.rounded-full{border-radius:9999px}.border{border:1px solid currentColor}.opacity-60{opacity:.6}.hover\\:opacity-100:hover{opacity:1}.transition{transition:all .2s}
        .text-\\[11vw\\]{font-size:11vw}.text-\\[9vw\\]{font-size:9vw}.text-\\[6\\.2vw\\]{font-size:6.2vw}.text-\\[4vw\\]{font-size:4vw}
      `}</style>

      <div className="flex items-baseline gap-3">
        <TimeGroup label="hours" value={hh} digitClass="text-[11vw] md:text-[9vw]" />
        <RoundedColon blink className="text-[11vw] md:text-[9vw]" />
        <TimeGroup label="minutes" value={mm} digitClass="text-[11vw] md:text-[9vw]" />
        <TimeGroup label="seconds" value={ss} digitClass="text-[6.2vw] md:text-[4.6vw]" groupClass="ml-2 opacity-80" />
        {twelveHour && (
          <span aria-label="am-pm" className="digital7 ml-2" style={{ fontSize: '4vw', lineHeight: 1 }}> {ampm} </span>
        )}
      </div>

      <button onClick={() => setPanelOpen(true)}
              className="fixed bottom-3 left-1/2 px-3 py-1 rounded-full border opacity-60 hover:opacity-100"
              aria-label="Open settings"
              style={{ transform: 'translateX(-50%)' }}>
        Swipe up or click for settings
      </button>

      <SettingsPanel
        open={panelOpen} onClose={() => setPanelOpen(false)}
        twelveHour={twelveHour} onTwelveHour={setTwelveHour}
        fgColor={fgColor} bgColor={bgColor}
        onFgColor={setFgColor} onBgColor={setBgColor}
      />
    </div>
  );
}

function TimeGroup({ label, value, digitClass = "", groupClass = "" }) {
  return (
    <div className={`flex items-baseline gap-[0.4vw] ${groupClass}`} aria-label={label}>
      {[...value].map((ch, i) => (
        <FlipDigit key={label + i} value={ch} sizeClass={digitClass || "text-[11vw] md:text-[9vw]"} />
      ))}
    </div>
  );
}

function FlipDigit({ value, sizeClass }) {
  const [current, setCurrent] = React.useState(value);
  const [next, setNext] = React.useState(null);
  const [anim, setAnim] = React.useState(false);

  React.useEffect(() => {
    if (value !== current) {
      setNext(value);
      const id = requestAnimationFrame(() => setAnim(true));
      const done = setTimeout(() => { setCurrent(value); setNext(null); setAnim(false); }, 480);
      return () => { cancelAnimationFrame(id); clearTimeout(done); };
    }
  }, [value, current]);

  return (
    <span className={`flip-digit digital7 ${sizeClass}`} aria-hidden>
      <span className="select-none" style={{ opacity: 0 }}>8</span>
      <span className="flip-face clip-top abs-fill flex items-start justify-center">{current}</span>
      <span className="flip-face clip-bottom abs-fill flex items-end justify-center">{current}</span>
      {next !== null && (
        <>
          <span className={`flip-layer flip-upper clip-top ${anim ? 'run-top' : ''} flex items-start justify-center`}>{current}</span>
          <span className={`flip-layer flip-lower clip-bottom ${anim ? 'run-bottom' : ''} flex items-end justify-center`}>{next}</span>
        </>
      )}
    </span>
  );
}

function RoundedColon({ blink = true, className = "" }) {
  return (
    <span aria-hidden className={`inline-flex flex-col items-center justify-center ${className} ${blink ? "blink" : ""}`}>
      <span className="colon-dot" />
      <span className="colon-dot" style={{ marginTop: '0.28em' }} />
    </span>
  );
}

function SettingsPanel({ open, onClose, twelveHour, onTwelveHour, fgColor, bgColor, onFgColor, onBgColor }) {
  const startY = React.useRef(null);
  const onTouchStart = (e) => { startY.current = e.touches[0].clientY; };
  const onTouchEnd = (e) => {
    const endY = e.changedTouches[0].clientY;
    if (startY.current !== null && endY - startY.current > 40) onClose();
    startY.current = null;
  };

  return (
    <div role="dialog" aria-modal="true"
      className={`fixed left-0 right-0 bottom-0 z-50 transition-transform`} 
      style={{ transform: open ? 'translateY(0)' : 'translateY(100%)', transitionDuration: '300ms', transitionTimingFunction: 'ease-out' }}
      onTouchStart={onTouchStart} onTouchEnd={onTouchEnd}>
      <div className="mx-auto" style={{ maxWidth: 640 }}>
        <div style="display:none"></div>
        <div style="display:none"></div>
        <div className="w-full rounded-t-2xl" style={{ boxShadow: '0 8px 24px rgba(0,0,0,.15)', border: '1px solid rgba(0,0,0,.1)', background: '#fff', color: '#111' }}>
          <div className="w-full flex justify-center" style={{ padding: '8px 0' }}>
            <div className="h-1.5 w-12 rounded-full" style={{ background: '#e5e5e5' }}></div>
          </div>
          <div style={{ padding: '8px 20px 20px', display: 'grid', gap: 16 }}>
            <div className="flex items-center justify-between">
              <h2 className="text-base" style={{ fontWeight: 500 }}>Settings</h2>
              <button onClick={onClose} className="text-sm px-3 py-1 rounded border" style={{ borderColor: '#d4d4d4' }}>Close</button>
            </div>

            <fieldset style={{ display: 'grid', gap: 8 }}>
              <legend className="text-sm" style={{ fontWeight: 500 }}>Time format</legend>
              <label className="flex items-center gap-2 text-sm">
                <input type="radio" name="format" checked={!twelveHour} onChange={() => onTwelveHour(false)} />
                24-hour
              </label>
              <label className="flex items-center gap-2 text-sm">
                <input type="radio" name="format" checked={twelveHour} onChange={() => onTwelveHour(true)} />
                12-hour (show AM/PM)
              </label>
            </fieldset>

            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 16 }}>
              <label className="text-sm flex items-center justify-between gap-3">
                <span>Font color</span>
                <input type="color" value={fgColor} onChange={(e) => onFgColor(e.target.value)} className="h-9 w-16 p-0 border rounded bg-transparent" aria-label="Choose font color" />
              </label>
              <label className="text-sm flex items-center justify-between gap-3">
                <span>Background</span>
                <input type="color" value={bgColor} onChange={(e) => onBgColor(e.target.value)} className="h-9 w-16 p-0 border rounded bg-transparent" aria-label="Choose background color" />
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

/* helpers */
function pad2(n) { return n.toString().padStart(2, "0"); }
function formatParts(d, twelveHour) {
  let h = d.getHours();
  const ampm = h >= 12 ? "PM" : "AM";
  if (twelveHour) { h = h % 12 || 12; }
  const hh = pad2(h), mm = pad2(d.getMinutes()), ss = pad2(d.getSeconds());
  return { hh, mm, ss, ampm };
}
function getStored(k, f){ try{ const v = localStorage.getItem(k); return v ?? f; } catch{ return f; } }
function getStoredBool(k, f){ try{ const v = localStorage.getItem(k); return v ? v === 'true' : f; } catch{ return f; } }
function store(k, v){ try{ localStorage.setItem(k, v); } catch{} }

/* Render */
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<FlipClock />);
</script>
</html>
